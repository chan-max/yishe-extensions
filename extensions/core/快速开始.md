# Core 插件快速开始

## 安装步骤

1. **打开 Chrome 扩展管理页面**
   - 在地址栏输入：`chrome://extensions/`
   - 或者：菜单 → 更多工具 → 扩展程序

2. **启用开发者模式**
   - 打开右上角的"开发者模式"开关

3. **加载插件**
   - 点击"加载已解压的扩展程序"
   - 选择 `core` 文件夹
   - 点击"选择文件夹"

4. **完成安装**
   - 插件会显示在扩展列表中
   - 浏览器工具栏会显示插件图标（如果没有图标，会显示默认图标）

## 使用方法

1. **打开任意网页**
   - 比如：https://www.baidu.com

2. **查看悬浮机器人**
   - 页面右下角会显示一个机器人图标 🤖
   - 机器人可以拖拽移动位置

3. **点击机器人**
   - 点击机器人图标，会弹出功能菜单
   - 菜单会显示当前网站对应的功能

4. **使用功能**
   - 点击菜单中的功能项执行相应操作
   - 点击菜单外部或再次点击机器人可关闭菜单

## 配置网站

### 添加新网站

1. **编辑配置文件**
   - 打开 `config/sites.json`
   - 添加新网站配置：

```json
{
  "id": "newsite",
  "name": "新网站",
  "domains": ["newsite.com", "www.newsite.com"],
  "enabled": true,
  "module": "newsite"
}
```

2. **创建功能模块文件夹**
   - 创建文件夹 `content/sites/newsite/`
   - 创建文件 `content/sites/newsite/index.js`
   - 实现功能：

```javascript
// content/sites/newsite/index.js

// 创建全局网站模块对象
if (!window.CoreSiteModules) {
  window.CoreSiteModules = {};
}

window.CoreSiteModules.newsite = {
  init(siteInfo) {
    console.log('新网站功能模块已加载', siteInfo);
  },

  async getMenuItems(siteInfo) {
    return [
      {
        icon: '🎯',
        label: '我的功能',
        action: () => {
          alert('执行我的功能');
        }
      }
    ];
  }
};
```

3. **重新加载插件**
   - 在 `chrome://extensions/` 页面点击刷新按钮
   - 刷新网页，新功能即可使用

## 文件说明

### 目录结构

```
core/
├── manifest.json                 # 插件配置文件
├── config/
│   └── sites.json               # 网站配置
├── content/
│   ├── content-base.js          # 基础脚本
│   ├── components/
│   │   └── floating-robot.js    # 悬浮机器人组件
│   ├── sites/
│   │   ├── common.js            # 通用功能
│   │   ├── site1/               # 网站1文件夹
│   │   │   └── index.js         # 网站1功能
│   │   └── site2/               # 网站2文件夹
│   │       └── index.js         # 网站2功能
│   └── utils/                   # 工具函数
└── popup/                       # 弹窗
```

### 重要文件

- `manifest.json` - 插件配置文件
- `config/sites.json` - 网站配置（定义哪些网站对应哪些模块）
- `content/content-base.js` - 基础脚本（初始化机器人）
- `content/components/floating-robot.js` - 悬浮机器人组件
- `content/utils/` - 工具函数
- `content/sites/common.js` - 通用功能（所有网站）
- `content/sites/{模块名}/index.js` - 网站特定功能

## 目录组织说明

- **通用功能**: 放在 `content/sites/common.js`，所有网站都会加载
- **网站特定功能**: 放在 `content/sites/{模块名}/index.js`，只有匹配的网站才会加载
- **模块文件夹**: 每个网站的功能放在独立的文件夹中，便于组织和管理

## 多文件组织

如果一个网站的功能比较复杂，可以在模块文件夹中创建多个文件：

```
content/sites/newsite/
├── index.js          # 主模块文件（必需）
├── utils.js          # 工具函数
├── crawler.js        # 爬虫功能
└── styles.css        # 样式文件
```

## 常见问题

**Q: 机器人图标不显示？**  
A: 检查浏览器控制台是否有错误，确保页面已完全加载。

**Q: 功能菜单不显示？**  
A: 检查浏览器控制台是否有错误，确保网站配置正确，模块文件存在。

**Q: 如何修改机器人位置？**  
A: 编辑 `content/styles/robot.css` 中的 `.core-robot-container` 样式。

**Q: 如何添加新功能？**  
A: 在对应的网站模块文件夹中修改 `index.js` 文件，添加菜单项和功能函数。

**Q: 为什么网站功能要放在文件夹中？**  
A: 便于组织和管理多个文件，当一个网站的功能比较复杂时，可以在文件夹中创建多个文件。

## 下一步

- 修改 `config/sites.json` 配置你的网站
- 在 `content/sites/` 目录创建你的功能模块文件夹
- 自定义机器人样式和功能

祝使用愉快！🎉
